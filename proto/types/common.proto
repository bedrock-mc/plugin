syntax = "proto3";
package df.plugin;
option go_package = "github.com/bedrock-mc/plugin/proto/generated";

enum GameMode {
    SURVIVAL = 0;
    CREATIVE = 1;
    ADVENTURE = 2;
    SPECTATOR = 3;
}

enum Difficulty {
    PEACEFUL = 0;
    EASY = 1;
    NORMAL = 2;
    HARD = 3;
}

// EffectType mirrors Dragonfly's registered effect IDs for straightforward mapping.
// Keep numeric values aligned with dragonfly/server/entity/effect/register.go.
enum EffectType {
    EFFECT_UNKNOWN = 0;
    SPEED = 1;
    SLOWNESS = 2;
    HASTE = 3;
    MINING_FATIGUE = 4;
    STRENGTH = 5;
    INSTANT_HEALTH = 6;
    INSTANT_DAMAGE = 7;
    JUMP_BOOST = 8;
    NAUSEA = 9;
    REGENERATION = 10;
    RESISTANCE = 11;
    FIRE_RESISTANCE = 12;
    WATER_BREATHING = 13;
    INVISIBILITY = 14;
    BLINDNESS = 15;
    NIGHT_VISION = 16;
    HUNGER = 17;
    WEAKNESS = 18;
    POISON = 19;
    WITHER = 20;
    HEALTH_BOOST = 21;
    ABSORPTION = 22;
    SATURATION = 23;
    LEVITATION = 24;
    FATAL_POISON = 25;
    CONDUIT_POWER = 26;
    SLOW_FALLING = 27;
    // 28, 29 intentionally omitted (Bad Omen, Hero of the Village - not implemented)
    DARKNESS = 30;
}

// Sound is a curated list of common sounds that don't require extra parameters.
// For sounds that require additional context (e.g., BlockPlace, Note), adapters
// may use sensible defaults or ignore extra semantics for now.
enum Sound {
    SOUND_UNKNOWN = 0;
    ATTACK = 1;
    DROWNING = 2;
    BURNING = 3;
    FALL = 4;
    BURP = 5;
    POP = 6;
    EXPLOSION = 7;
    THUNDER = 8;
    LEVEL_UP = 9;
    EXPERIENCE = 10;
    FIREWORK_LAUNCH = 11;
    FIREWORK_HUGE_BLAST = 12;
    FIREWORK_BLAST = 13;
    FIREWORK_TWINKLE = 14;
    TELEPORT = 15;
    ARROW_HIT = 16;
    ITEM_BREAK = 17;
    ITEM_THROW = 18;
    TOTEM = 19;
    FIRE_EXTINGUISH = 20;
}

message Vec3 {
    double x = 1;
    double y = 2;
    double z = 3;
}

message Rotation {
    float yaw = 1;
    float pitch = 2;
}

message BBox {
    Vec3 min = 1;
    Vec3 max = 2;
}

message BlockPos {
    int32 x = 1;
    int32 y = 2;
    int32 z = 3;
}

message ItemStack {
    string name = 1;
    int32 meta = 2;
    int32 count = 3;
}

message BlockState {
    string name = 1;
    map<string, string> properties = 2;
}

message LiquidState {
    BlockState block = 1;
    int32 depth = 2;
    bool falling = 3;
    string liquid_type = 4;
}

message WorldRef {
    string name = 1;
    string dimension = 2;
    string id = 3; // This is a runtime id. it changes across server restarts.
}

message EntityRef {
    string uuid = 1;
    string type = 2;
    optional string name = 3;
    optional Vec3 position = 4;
    optional Rotation rotation = 5;
}

message DamageSource {
    string type = 1;
    optional string description = 2;
}

message HealingSource {
    string type = 1;
    optional string description = 2;
}

message Address {
    string host = 1;
    int32 port = 2;
}

// Category for creative inventory
enum ItemCategory {
    ITEM_CATEGORY_CONSTRUCTION = 0;
    ITEM_CATEGORY_NATURE = 1;
    ITEM_CATEGORY_EQUIPMENT = 2;
    ITEM_CATEGORY_ITEMS = 3;
}

// CustomItemDefinition defines a custom (non-vanilla) item that requires
// a resource pack and client-side registration
message CustomItemDefinition {
    string id = 1; // Unique identifier for the custom item (e.g., "my_plugin:custom_sword")
    string display_name = 2; // Display name shown to players
    bytes texture_data = 3; // Texture data encoded as PNG bytes
    ItemCategory category = 4; // Creative inventory category
    optional string group = 5; // Optional subgroup within the category (e.g., "sword", "pickaxe", "food")
    int32 meta = 6; // Metadata value for this item (defaults to 0)
}

// Custom block support
enum CustomBlockRenderMethod {
    CUSTOM_BLOCK_RENDER_METHOD_OPAQUE = 0;
    CUSTOM_BLOCK_RENDER_METHOD_ALPHA_TEST = 1;
    CUSTOM_BLOCK_RENDER_METHOD_BLEND = 2;
    CUSTOM_BLOCK_RENDER_METHOD_DOUBLE_SIDED = 3;
}

message CustomBlockTexture {
    string name = 1;         // Texture name used by materials (e.g., "my_block" or "my_block_side")
    bytes image_png = 2;     // PNG-encoded bytes
}

message CustomBlockMaterial {
    string target = 1;                 // "*", "up", "down", "north", "south", "east", "west"
    string texture_name = 2;           // Must match a CustomBlockTexture.name
    CustomBlockRenderMethod render_method = 3; // Optional, defaults to OPAQUE
    optional bool face_dimming = 4;           // Optional: defaults true
    optional bool ambient_occlusion = 5;      // Optional: defaults based on render_method
}

message CustomBlockProperties {
    optional BBox collision_box = 1;
    optional BBox selection_box = 2;
    optional string geometry_identifier = 3; // e.g., "geometry.my_block"
    bool cube = 4;                            // true to use unit cube geometry when no identifier is provided
    optional string map_colour = 5;           // hex string like "#RRGGBB" for map colour
    optional Vec3 rotation = 6;               // integer degrees (90-degree increments), x/y/z
    optional Vec3 translation = 7;            // translation vector
    optional Vec3 scale = 8;                  // scaling factor
    repeated CustomBlockMaterial materials = 10; // material instances by target
    // Client-side state properties and permutations (pack-only; no runtime IDs).
    map<string, CustomBlockStateValues> states = 20;
    repeated CustomBlockPermutation permutations = 21;
}

message CustomBlockDefinition {
    string id = 1;                             // e.g., "my_plugin:my_block"
    string display_name = 2;                   // display name for language entry
    optional bytes geometry_json = 3;          // optional geometry JSON for models/blocks/<name>.geo.json
    repeated CustomBlockTexture textures = 4;  // textures referred by materials
    CustomBlockProperties properties = 5;      // server/client properties/components
}

// Value list for a single custom block property (strings parsed to bool/int/float where possible).
message CustomBlockStateValues {
    repeated string values = 1;
}

// Permutation with molang condition and property overrides.
message CustomBlockPermutation {
    string condition = 1;
    CustomBlockProperties properties = 2;
}
